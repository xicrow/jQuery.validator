/**
 * cosyValidator
 * @author Jan Ebsen <xicrow@gmail.com>
 * @version 1.0.0
 * @date 2014-02-06
 * @copyright Jan Ebsen 2014
 */
!function(a){a.cosyValidator={defaultOptions:{validateOnInit:!1,validateOnSubmit:!0,validateOnReset:!1,errorContainerClassName:"",rules:{},messages:{}},init:function(b,c){c=a.extend({},a.cosyValidator.defaultOptions,c),c.validateOnInit&&a.cosyValidator.validateForm(b,c),c.validateOnSubmit&&a(b).on("submit",function(){return a.cosyValidator.validateForm(this,c)}),a(b).on("reset",function(){a(b).find(".cosyValidator-error").remove(),a(b).find(".cosyValidator-valid").removeClass("cosyValidator-valid"),a(b).find(".cosyValidator-invalid").removeClass("cosyValidator-invalid"),c.validateOnReset&&(window.cosyValidatorForm=this,window.cosyValidatorOptions=c,setTimeout(function(){a.cosyValidator.validateForm(cosyValidatorForm,cosyValidatorOptions)},1))}),c.rules&&a.each(c.rules,function(d){a(b).find("[name="+d+"]").on({blur:function(){a.cosyValidator.validateElement(b,d,c)},keyup:function(){a.cosyValidator.validateElement(b,d,c)},change:function(){a.cosyValidator.validateElement(b,d,c)}})})},validateForm:function(b,c){var d=!0;return c.rules&&a.each(c.rules,function(e){result=a.cosyValidator.validateElement(b,e,c),result||(d=!1)}),d},validateElement:function(b,c,d){var e=a(b).find("[name="+c+"]");if(0==e.length){var e=a(b).find("[name^="+c+"]");if(0==e.length)return window.console&&console.log("Undefined element in form "+b+" with name "+c+"."),!1}var f=e.val(),g=a(".cosyValidator-error-"+c);g.length||(elmAppendTo=e.parent(),"label"==e.parent()[0].nodeName.toLowerCase()?elmAppendTo=e.parent().parent():"div"==e.parent()[0].nodeName.toLowerCase()&&"input-group"==e.parent()[0].className&&(elmAppendTo=e.parent().parent()),g=a("<div></div>").addClass("cosyValidator-error").addClass("cosyValidator-error-"+c).appendTo(elmAppendTo).hide(),""!=d.errorContainerClassName&&g.addClass(d.errorContainerClassName));var h="",i=d.rules[c]||{},j=d.messages[c]||{};for(method in i){rule={method:method,parameters:i[method]};try{if(!a.cosyValidator.methods[method].call(this,f,e[0],rule.parameters)){h=j[method]?this.sprintf(j[method],rule.parameters):this.sprintf(a.cosyValidator.messages[method],rule.parameters);break}}catch(k){throw window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+rule.method+"' method.",k),k}}return""!=h?(e.removeClass("cosyValidator-valid"),e.addClass("cosyValidator-invalid"),g.html()!=h&&g.html(h),(g.is(":animated")||!g.is(":visible"))&&g.stop(!0,!0).slideDown(250),!1):(e.removeClass("cosyValidator-invalid"),e.addClass("cosyValidator-valid"),(g.is(":animated")||g.is(":visible"))&&g.stop(!0,!0).slideUp(250),!0)},elementIsCheckable:function(a){return/radio|checkbox/i.test(a.type)},elementGetLength:function(b){return"select"==b.nodeName.toLowerCase()?a("option:selected",b).length:"input"==b.nodeName.toLowerCase()&&this.elementIsCheckable(b)?a("[name="+b.name+"]").filter(":checked").length:a.trim(a(b).val()).length},sprintf:function(a){var b=arguments;if("undefined"==typeof b[1])return a;var c=1;return("object"==typeof b[1]||"array"==typeof b[1])&&(b=b[1],c=0),a.replace(/%((%)|s)/g,function(){return b[c++]})}},a.cosyValidator.messages={required:"Feltet er p\xe5kr\xe6vet",email:"Skriv venligst en gyldig e-mail adresse",url:"Skriv venligst en gyldig URL",date:"Skriv venligst en gyldig dato",dateISO:"Skriv venligst en gyldig dato (ISO)",number:"Skriv venligst en gyldig tal",digits:"Skriv venligst kun tal",minlength:a.cosyValidator.sprintf("Skriv venligst mindst %s tegn"),maxlength:a.cosyValidator.sprintf("Skriv venligst ikke flere end %s tegn"),rangelength:a.cosyValidator.sprintf("Skriv venligst mellem %s og %s tegn langt"),min:a.cosyValidator.sprintf("Skriv et tal mindre end eller lig med %s"),max:a.cosyValidator.sprintf("Skriv et tal st\xf8rre end eller lig med %s"),range:a.cosyValidator.sprintf("Skriv et tal mellem %s og %s"),equalTo:"Skriv venligst den samme v\xe6rdi igen"},a.cosyValidator.methods={required:function(b,c){if("select"===c.nodeName.toLowerCase()){var d=a(c).val();return d&&d.length>0}return a.cosyValidator.elementIsCheckable(c)?a.cosyValidator.elementGetLength(c)>0:a.trim(b).length>0},email:function(a){return/^(.+)@(.+)\.(.+)$/.test(a)},url:function(a){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a){return!/Invalid|NaN/.test(new Date(a).toString())},dateISO:function(a){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a)},number:function(a){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a){return/^\d+$/.test(a)},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.elementGetLength(c);return e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.elementGetLength(c);return d>=e},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.elementGetLength(c);return e>=d[0]&&e<=d[1]},min:function(a,b,c){return a>=c},max:function(a,b,c){return c>=a},range:function(a,b,c){return a>=c[0]&&a<=c[1]},equalTo:function(b,c,d){var e=a(d);return this.settings.onfocusout&&e.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()}),b===e.val()}},a.fn.extend({cosyValidator:function(b){return this.each(function(){a.cosyValidator.init(this,b)})}})}(jQuery);